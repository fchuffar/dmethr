---
title: "Step 4: results"
subtitle: "Hunting DNA methylation repression of transcriptional activity"
author: "Florence Pittion, Florent Chuffart"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
---



```{r, echo=FALSE, eval=TRUE}
knitr::opts_chunk$set(collapse=TRUE, comment = "#>", fig.width=9, fig.height=6, eval=TRUE, echo=FALSE, results="hide", warning=FALSE)

```

# Export features

We export gene as : 

```{r export_genes}
# WriteXLS::WriteXLS(feats, paste0("01_dnmt_genes_", version, "_dnmtkoup_methplusplus.xlsx"))
```


# Core feats

```{r core feats}
# plot 2 firsts studies
#threshold
#study 1
i = 1
#study 2
j = 1
layout(1, respect=TRUE)
plot(feats$wt_dko_l2fc, feats$aza_beta, xlab="Log2FoldChange WTvsDKO", ylab="Beta 5AZA")
idx = intersect(gs_methplusplus, rownames(feats))
points(feats[idx,]$wt_dko_l2fc, feats[idx,]$aza_beta, col=2, pch=1)
abline(h=i, col=2)
abline(v=j, col=2)
legend("topleft", pch=1, col=2, "gs_methplusplus")

featsup = rownames(feats[which(feats$wt_dko_l2fc>i & feats$aza_beta>j), ])
#gs_methplusplus = t(gs_methplusplus)
idx = intersect (featsup, gs_methplusplus)
corefeats = rownames(feats[idx,])
length(corefeats) 

```

# Expression in GTEx


```{r gtex}
```


# Multi omic analysis in in TCGA

```{r momik, eval=TRUE}
source("common.R")

tcga_project = "TCGA-LUSC"
gene_symbols =  idx

s_cnv   = mreadstudyRDS(paste0("tcga_studies/study_", tcga_project, "_cnv.rds"))
s_meth  = mreadstudyRDS(paste0("tcga_studies/study_", tcga_project, "_meth.rds"))
s_trscr = mreadstudyRDS(paste0("tcga_studies/study_", tcga_project, "_trscr.rds"))

for (gene_symbol in gene_symbols) {
  print(gene_symbol)
  # mdata = get_multiomic_data(gene_symbols=gene_symbol, tcga_project=tcga_project)  
  try(momic_pattern(gene_symbol, tcga_project))
}
```






# Session Information

```{r, results="verbatim"}
sessionInfo()
```



