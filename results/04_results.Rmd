---
title: "Step 4: Results"
subtitle: "Hunting DNA methylation repression of transcriptional activity"
author: "Florence Pittion, Florent Chuffart"
date: "`r Sys.Date()`"
output: 
  rmarkdown::html_document:
    toc: true
    toc_float: true
    toc_depth: 3
    number_sections: true
---



```{r, echo=FALSE, eval=TRUE}
knitr::opts_chunk$set(collapse=TRUE, comment = "#>", fig.width=9, fig.height=6, eval=TRUE, echo=FALSE, results="hide", warning=FALSE)

```

# Export features


```{r}
feat_export_filename = paste0("feats.xlsx")
```

Annotated features are exported as [`r feat_export_filename`](`r feat_export_filename`) file. 

```{r results="verbatim"}
head(feats)
```

```{r export_genes}
WriteXLS::WriteXLS(feats, feat_export_filename)
```


# Core feats

```{r core feats}
# plot 2 firsts studies
#threshold
#study 1
i = 1
#study 2
j = 1
layout(1, respect=TRUE)
plot(feats$l2fc_GSE45332, feats$l2fc_GSE5816, xlab="l2fc GSE45332 WTvsDKO", ylab="l2fc GSE5816", pch=".", col="grey")
idx = rownames(feats)[!is.na(feats$methplusplus) & feats$methplusplus]
points(feats[idx,]$l2fc_GSE45332, feats[idx,]$l2fc_GSE5816, col=2, pch=1)
abline(h=i, col=1, lty=2)
abline(v=j, col=1, lty=2)
legend("topleft", pch=1, col=2, "gs_methplusplus")

# features of interest
corefeats = rownames(feats)[feats$l2fc_GSE45332>i & feats$l2fc_GSE5816>j & !is.na(feats$methplusplus) & feats$methplusplus]
length(corefeats) 
```

# Expression in GTEx


```{r gtex}
```


# Multi omic analysis in in TCGA

```{r momik, eval=TRUE}
source("common.R")

tcga_project = "TCGA-LUSC"
gene_symbols =  idx

s_cnv   = mreadstudyRDS(paste0("tcga_studies/study_", tcga_project, "_cnv.rds"))
s_meth  = mreadstudyRDS(paste0("tcga_studies/study_", tcga_project, "_meth.rds"))
s_trscr = mreadstudyRDS(paste0("tcga_studies/study_", tcga_project, "_trscr.rds"))

for (gene_symbol in gene_symbols) {
  print(gene_symbol)
  # mdata = get_multiomic_data(gene_symbols=gene_symbol, tcga_project=tcga_project)  
  try(momic_pattern(gene_symbol, tcga_project))
}
```






# Session Information

```{r, results="verbatim"}
sessionInfo()
```



